# 智能提示增强 (Prompt Enhancement)

这是项目的核心价值所在，直接关系到如何利用你的8张表格为 LLM Agent 提供个性化。

## 具体实现思路

### 1. 个性化提示注入 (Personalized Prompt Injection)

**目标**: 根据用户的画像数据，自动将相关信息融入提示词，引导 LLM 生成更符合用户需求的输出。

**实现方式**:

#### 提取关键信息
从以下表格中提取与当前任务相关的数据：
- **Belief**: 用户的核心价值观、对某事的看法
- **Preference**: 喜欢的沟通风格、信息呈现方式
- **Long-term Goal**: 长期目标
- **Short-term Goal**: 短期目标

#### 动态构建提示片段

**场景示例**：
- 当前任务：撰写一份项目计划
- 用户偏好：偏好简洁明了的语言
- 用户信念：相信团队协作的重要性
- 短期目标：完成项目A的初步方案

**生成的提示片段**：
```
请以简洁明了的风格，撰写一份关于项目A的初步方案。
在方案中，请特别强调团队协作的方面，因为用户认为这是项目成功的关键。
```

#### 模板化与变量替换
设计提示词模板，将从数据库中提取的个性化信息作为变量填入。

**示例**：

**原始用户输入**：
```
帮我规划一下下周的工作。
```

**增强后提示**：
```
考虑到你的短期目标是[从Short-term Goal表读取]，
并且你倾向于[从Preference表读取工作方式偏好]，
请帮我规划一下下周的工作，
并确保计划能支持你的长期目标[从Long-term Goal表读取]。
```

---

### 2. 上下文感知 (Context Awareness)

**目标**: 根据用户的历史交互、过去的 Insight 和 Decision，动态调整 LLM 的行为和回应。

**实现方式**:

#### 利用历史数据

- **Insight**: 如果用户过去从某个错误中获得了教训（记录在 Insight 表），在相似情境下，提示 LLM 避免重蹈覆辙或主动提醒用户。

- **Decision**: 用户过去做出的重要决策及其理由可以作为 LLM 提供建议时的参考。

- **Methodology**: 用户偏好的思考方法或解决问题的框架可以指导 LLM 如何组织和呈现信息。

#### 会话历史摘要
将最近的交互历史进行摘要，提取关键信息，作为上下文注入到新的提示中。

**示例**：

**用户历史洞察**：
```
上次项目X因为沟通不足导致延期。
```

**当前任务**：
```
规划新项目Y。
```

**增强提示**：
```
在规划新项目Y时，请特别注意设计清晰的沟通计划，
吸取项目X中因沟通不足导致延期的教训(记录于用户Insight)。
```

---

### 3. 认知一致性保持 (Cognitive Consistency Keeping)

**目标**: 确保 LLM 的响应与用户的核心 Belief、价值观和已形成的 Methodology 不产生明显冲突，增强用户对 Agent 的信任感。

**实现方式**:

#### 信念检查
在 LLM 生成响应后，或在生成过程中，将其核心观点与用户 Belief 表中的条目进行比对。如果发现潜在冲突，可以：

1. 引导 LLM 修正响应
2. 向用户高亮潜在冲突点，并询问用户意见
3. （高级）训练一个小型模型来评估响应与用户信念的一致性

#### 方法论对齐
如果用户有特定的 Methodology（例如，决策时总是先列出优缺点），可以提示 LLM 在提供建议时遵循此方法论。

**示例**：

**用户信念**：
```
技术发展应以人为本。
```

**LLM 原始建议**：
```
为了效率最大化，可以考虑替换部分人工岗位。
```

**认知一致性处理后**：
```
在提出效率提升方案时，请确保方案符合用户'技术发展应以人为本'的信念。
思考如何在提升效率的同时，保障人的价值和发展。
```

---

## 总结

通过以上三个核心机制，智能提示增强系统能够：

1. **个性化定制**：根据用户画像自动调整提示内容
2. **历史感知**：利用用户过往经验和洞察优化建议
3. **价值对齐**：确保AI响应与用户核心信念保持一致

这样的系统将大大提升用户与AI交互的质量和满意度。
