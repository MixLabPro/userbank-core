# ä¸ªäººç”»åƒæ•°æ®åº“ç³»ç»Ÿ

åŸºäºSQLiteå’ŒMCPåè®®çš„ä¸ªäººæ€ç»´æ¨¡å¼å’Œè¡Œä¸ºç‰¹å¾æ•°æ®ç®¡ç†ç³»ç»Ÿã€‚

## ğŸ“‹ ç›®å½•

- [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
- [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
- [æ•°æ®åº“ç»“æ„](#æ•°æ®åº“ç»“æ„)
- [å®‰è£…å’Œé…ç½®](#å®‰è£…å’Œé…ç½®)
- [ä½¿ç”¨æ–¹æ³•](#ä½¿ç”¨æ–¹æ³•)
- [MCPå·¥å…·è¯´æ˜](#mcpå·¥å…·è¯´æ˜)
- [APIå‚è€ƒ](#apiå‚è€ƒ)
- [ç¤ºä¾‹ç”¨æ³•](#ç¤ºä¾‹ç”¨æ³•)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)

## ğŸ¯ ç³»ç»Ÿæ¦‚è¿°

ä¸ªäººç”»åƒæ•°æ®åº“ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºè®¤çŸ¥ç§‘å­¦ç†è®ºçš„ä¸ªäººæ•°æ®ç®¡ç†å·¥å…·ï¼Œå°†ä¸ªäººçš„æ€ç»´æ¨¡å¼å’Œè¡Œä¸ºç‰¹å¾æŒ‰ç…§ä¸‰å±‚å…«ç±»æ¡†æ¶è¿›è¡Œåˆ†ç±»å­˜å‚¨ï¼š

### ä¸‰å±‚å…«ç±»æ¡†æ¶

**è®¤çŸ¥å±‚ (Cognition Layer)**
- **ä¿¡å¿µ (Belief)**: å¯¹äº‹ç‰©çš„åˆ¤æ–­æ€§é™ˆè¿°å’Œæœªæ¥é¢„æµ‹
- **æ´å¯Ÿ (Insight)**: é€šè¿‡ç»å†è·å¾—çš„æ·±å±‚è®¤è¯†
- **å…³æ³¨ç‚¹ (Focus)**: æ³¨æ„åŠ›æŠ•æ”¾çš„é¢†åŸŸå’Œä¸»é¢˜

**åŠ¨æœºå±‚ (Motivation Layer)**
- **é•¿æœŸç›®æ ‡ (Long-term Goal)**: 1å¹´ä»¥ä¸Šçš„æŠ½è±¡æœŸæœ›çŠ¶æ€
- **çŸ­æœŸç›®æ ‡ (Short-term Goal)**: 1å¹´å†…çš„å…·ä½“å¯è¡¡é‡ç›®æ ‡
- **åå¥½ (Preference)**: ä¸ªäººé€‰æ‹©æ—¶çš„ç¨³å®šå€¾å‘æ€§

**è¡Œä¸ºå±‚ (Action Layer)**
- **å†³ç­– (Decision)**: ç‰¹å®šåœºæ™¯ä¸‹çš„å…·ä½“é€‰æ‹©
- **æ–¹æ³•è®º (Methodology)**: å®ç°ç›®æ ‡çš„ç³»ç»Ÿæ€§è·¯å¾„

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- ğŸ—„ï¸ **å®Œæ•´çš„CRUDæ“ä½œ**: å¢åŠ ã€æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤è®°å½•
- ğŸ” **æ™ºèƒ½æœç´¢**: æ”¯æŒå…³é”®è¯æœç´¢å’Œè·¨è¡¨æœç´¢
- ğŸ“Š **æ•°æ®åˆ†æ**: æƒ…ç»ªåˆ†å¸ƒã€ä¸»é¢˜é¢‘ç‡ã€æ—¶é—´è¶‹åŠ¿åˆ†æ
- ğŸ“ˆ **ç»Ÿè®¡æŠ¥å‘Š**: å®æ—¶æ•°æ®ç»Ÿè®¡å’Œå¯è§†åŒ–æ‘˜è¦
- ğŸ”„ **æ•°æ®å¯¼å‡º**: JSONæ ¼å¼çš„å®Œæ•´æ•°æ®å¯¼å‡º

### æŠ€æœ¯ç‰¹æ€§
- ğŸš€ **é«˜æ€§èƒ½**: SQLiteæ•°æ®åº“ï¼Œæ”¯æŒç´¢å¼•ä¼˜åŒ–
- ğŸ›¡ï¸ **æ•°æ®å®‰å…¨**: è¾“å…¥éªŒè¯å’ŒSQLæ³¨å…¥é˜²æŠ¤
- ğŸ“ **è¯¦ç»†æ—¥å¿—**: å®Œæ•´çš„æ“ä½œæ—¥å¿—è®°å½•
- ğŸ”§ **æ˜“äºæ‰©å±•**: æ¨¡å—åŒ–è®¾è®¡ï¼Œæ”¯æŒè‡ªå®šä¹‰æ‰©å±•
- ğŸŒ **MCPåè®®**: æ ‡å‡†åŒ–çš„å·¥å…·æ¥å£

## ğŸ—ƒï¸ æ•°æ®åº“ç»“æ„

### è¡¨ç»“æ„è¯´æ˜

æ‰€æœ‰è¡¨éƒ½åŒ…å«ä»¥ä¸‹åŸºç¡€å­—æ®µï¼š
- `id`: ä¸»é”®ï¼Œè‡ªåŠ¨é€’å¢
- `content`: è®°å½•å†…å®¹ï¼ˆå¿…å¡«ï¼‰
- `related`: ç›¸å…³ä¸»é¢˜æ ‡ç­¾ï¼ˆJSONæ•°ç»„æ ¼å¼ï¼‰
- `emotion`: æƒ…ç»ªæ ‡ç­¾ï¼ˆç§¯æ/æ¶ˆæ/ä¸­æ€§ç­‰ï¼‰
- `create_time`: åˆ›å»ºæ—¶é—´
- `update_time`: æ›´æ–°æ—¶é—´

### ç‰¹æ®Šå­—æ®µ

**é•¿æœŸç›®æ ‡è¡¨ (long_term_goals)**
- `status`: çŠ¶æ€ï¼ˆactive/completed/paused/cancelledï¼‰

**çŸ­æœŸç›®æ ‡è¡¨ (short_term_goals)**
- `status`: çŠ¶æ€
- `deadline`: æˆªæ­¢æ—¥æœŸ

**åå¥½è¡¨ (preferences)**
- `strength`: åå¥½å¼ºåº¦ï¼ˆ1-10ï¼‰

**å†³ç­–è¡¨ (decisions)**
- `context`: å†³ç­–èƒŒæ™¯
- `outcome`: å†³ç­–ç»“æœ

**æ–¹æ³•è®ºè¡¨ (methodologies)**
- `category`: æ–¹æ³•è®ºåˆ†ç±»
- `effectiveness`: æœ‰æ•ˆæ€§è¯„åˆ†ï¼ˆ1-10ï¼‰

## ğŸš€ å®‰è£…å’Œé…ç½®

### 1. ç¯å¢ƒè¦æ±‚
- Python 3.8+
- å·²å®‰è£…çš„ä¾èµ–åŒ…ï¼ˆè§requirements.txtï¼‰

### 2. å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

### 3. è¿è¡Œæµ‹è¯•
```bash
python run_tests.py
```

### 4. å¯åŠ¨MCPæœåŠ¡å™¨
```bash
python run_server.py
```

## ğŸ“– ä½¿ç”¨æ–¹æ³•

### åŸºç¡€ä½¿ç”¨

#### 1. ç›´æ¥ä½¿ç”¨æ•°æ®åº“ç±»
```python
from src.database import PersonalProfileDatabase

# åˆå§‹åŒ–æ•°æ®åº“
db = PersonalProfileDatabase("my_profile.db")

# æ·»åŠ ä¿¡å¿µè®°å½•
belief_data = {
    "content": "æŒç»­å­¦ä¹ æ˜¯æˆåŠŸçš„å…³é”®",
    "related": ["å­¦ä¹ ", "æˆé•¿", "æˆåŠŸ"],
    "emotion": "ç§¯æ"
}
record_id = db.insert_record("beliefs", belief_data)

# æŸ¥è¯¢è®°å½•
records = db.get_records("beliefs", limit=10)

# æœç´¢è®°å½•
results = db.search_records("beliefs", "å­¦ä¹ ")
```

#### 2. ä½¿ç”¨MCPå·¥å…·
é€šè¿‡MCPåè®®è°ƒç”¨å·¥å…·ï¼ˆéœ€è¦MCPå®¢æˆ·ç«¯ï¼‰ï¼š

```json
{
  "tool": "add_record",
  "arguments": {
    "table_name": "belief",
    "content": "AIå°†æ”¹å˜æœªæ¥çš„å·¥ä½œæ–¹å¼",
    "related": ["AI", "æœªæ¥", "å·¥ä½œ"],
    "emotion": "ç§¯æ"
  }
}
```

## ğŸ› ï¸ MCPå·¥å…·è¯´æ˜

### 1. add_record
**åŠŸèƒ½**: æ·»åŠ æ–°è®°å½•åˆ°æŒ‡å®šè¡¨
**å‚æ•°**:
- `table_name`: è¡¨åï¼ˆå¿…å¡«ï¼‰
- `content`: è®°å½•å†…å®¹ï¼ˆå¿…å¡«ï¼‰
- `related`: ç›¸å…³ä¸»é¢˜æ•°ç»„ï¼ˆå¿…å¡«ï¼‰
- `emotion`: æƒ…ç»ªæ ‡ç­¾ï¼ˆå¯é€‰ï¼Œé»˜è®¤"ä¸­æ€§"ï¼‰
- `extra_fields`: é¢å¤–å­—æ®µï¼ˆå¯é€‰ï¼‰

### 2. get_records
**åŠŸèƒ½**: è·å–è®°å½•åˆ—è¡¨
**å‚æ•°**:
- `table_name`: è¡¨åï¼ˆå¿…å¡«ï¼‰
- `limit`: è¿”å›è®°å½•æ•°ï¼ˆå¯é€‰ï¼Œé»˜è®¤20ï¼‰
- `offset`: åç§»é‡ï¼ˆå¯é€‰ï¼Œé»˜è®¤0ï¼‰
- `order_by`: æ’åºå­—æ®µï¼ˆå¯é€‰ï¼Œé»˜è®¤"create_time DESC"ï¼‰

### 3. search_records
**åŠŸèƒ½**: æœç´¢è®°å½•
**å‚æ•°**:
- `keyword`: æœç´¢å…³é”®è¯ï¼ˆå¿…å¡«ï¼‰
- `table_name`: è¡¨åï¼ˆå¯é€‰ï¼Œé»˜è®¤"all"æœç´¢æ‰€æœ‰è¡¨ï¼‰
- `limit`: è¿”å›è®°å½•æ•°ï¼ˆå¯é€‰ï¼Œé»˜è®¤20ï¼‰

### 4. update_record
**åŠŸèƒ½**: æ›´æ–°æŒ‡å®šè®°å½•
**å‚æ•°**:
- `table_name`: è¡¨åï¼ˆå¿…å¡«ï¼‰
- `record_id`: è®°å½•IDï¼ˆå¿…å¡«ï¼‰
- `content`: æ–°å†…å®¹ï¼ˆå¯é€‰ï¼‰
- `related`: æ–°ç›¸å…³ä¸»é¢˜ï¼ˆå¯é€‰ï¼‰
- `emotion`: æ–°æƒ…ç»ªæ ‡ç­¾ï¼ˆå¯é€‰ï¼‰
- `extra_fields`: å…¶ä»–å­—æ®µï¼ˆå¯é€‰ï¼‰

### 5. delete_record
**åŠŸèƒ½**: åˆ é™¤æŒ‡å®šè®°å½•
**å‚æ•°**:
- `table_name`: è¡¨åï¼ˆå¿…å¡«ï¼‰
- `record_id`: è®°å½•IDï¼ˆå¿…å¡«ï¼‰

### 6. get_statistics
**åŠŸèƒ½**: è·å–æ•°æ®åº“ç»Ÿè®¡ä¿¡æ¯
**å‚æ•°**: æ— 

### 7. get_recent_records
**åŠŸèƒ½**: è·å–æœ€è¿‘çš„è®°å½•
**å‚æ•°**:
- `days`: å¤©æ•°ï¼ˆå¯é€‰ï¼Œé»˜è®¤7å¤©ï¼‰
- `limit`: è®°å½•æ•°é™åˆ¶ï¼ˆå¯é€‰ï¼Œé»˜è®¤50ï¼‰

### 8. analyze_patterns
**åŠŸèƒ½**: åˆ†ææ•°æ®æ¨¡å¼
**å‚æ•°**:
- `analysis_type`: åˆ†æç±»å‹ï¼ˆå¯é€‰ï¼‰
  - `emotion_distribution`: æƒ…ç»ªåˆ†å¸ƒ
  - `topic_frequency`: ä¸»é¢˜é¢‘ç‡
  - `time_trends`: æ—¶é—´è¶‹åŠ¿
  - `goal_progress`: ç›®æ ‡è¿›åº¦
- `time_range`: åˆ†ææ—¶é—´èŒƒå›´å¤©æ•°ï¼ˆå¯é€‰ï¼Œé»˜è®¤30å¤©ï¼‰

## ğŸ“š APIå‚è€ƒ

### æ•°æ®åº“ç±»æ–¹æ³•

#### PersonalProfileDatabase

```python
class PersonalProfileDatabase:
    def __init__(self, db_path: str = "personal_profile.db")
    def insert_record(self, table_name: str, data: Dict[str, Any]) -> int
    def get_records(self, table_name: str, limit: int = 100, offset: int = 0, order_by: str = "create_time DESC") -> List[Dict[str, Any]]
    def search_records(self, table_name: str, keyword: str, limit: int = 50) -> List[Dict[str, Any]]
    def update_record(self, table_name: str, record_id: int, data: Dict[str, Any]) -> bool
    def delete_record(self, table_name: str, record_id: int) -> bool
    def get_statistics(self) -> Dict[str, int]
```

## ğŸ’¡ ç¤ºä¾‹ç”¨æ³•

### ç¤ºä¾‹1: è®°å½•å­¦ä¹ å¿ƒå¾—
```python
# æ·»åŠ æ´å¯Ÿè®°å½•
insight_data = {
    "content": "é€šè¿‡å®è·µå‘ç°ï¼Œç•ªèŒ„å·¥ä½œæ³•ç¡®å®èƒ½æé«˜ä¸“æ³¨åº¦",
    "related": ["å­¦ä¹ æ–¹æ³•", "ä¸“æ³¨", "æ•ˆç‡"],
    "emotion": "ç§¯æ"
}
db.insert_record("insights", insight_data)

# æ·»åŠ å¯¹åº”çš„æ–¹æ³•è®º
methodology_data = {
    "content": "ä½¿ç”¨25åˆ†é’Ÿä¸“æ³¨+5åˆ†é’Ÿä¼‘æ¯çš„ç•ªèŒ„å·¥ä½œæ³•",
    "related": ["æ—¶é—´ç®¡ç†", "ä¸“æ³¨", "æ•ˆç‡"],
    "emotion": "ç§¯æ",
    "category": "æ—¶é—´ç®¡ç†",
    "effectiveness": 8
}
db.insert_record("methodologies", methodology_data)
```

### ç¤ºä¾‹2: è®¾å®šå’Œè·Ÿè¸ªç›®æ ‡
```python
# è®¾å®šçŸ­æœŸç›®æ ‡
short_goal = {
    "content": "ä¸‰ä¸ªæœˆå†…å®ŒæˆPythoné«˜çº§ç¼–ç¨‹è¯¾ç¨‹",
    "related": ["å­¦ä¹ ", "ç¼–ç¨‹", "Python"],
    "emotion": "ç§¯æ",
    "status": "active",
    "deadline": "2024-06-01"
}
db.insert_record("short_term_goals", short_goal)

# è®¾å®šé•¿æœŸç›®æ ‡
long_goal = {
    "content": "æˆä¸ºå…¨æ ˆå¼€å‘å·¥ç¨‹å¸ˆ",
    "related": ["èŒä¸šå‘å±•", "ç¼–ç¨‹", "æŠ€èƒ½"],
    "emotion": "ç§¯æ",
    "status": "active"
}
db.insert_record("long_term_goals", long_goal)
```

### ç¤ºä¾‹3: è®°å½•å†³ç­–è¿‡ç¨‹
```python
# è®°å½•æŠ€æœ¯é€‰æ‹©å†³ç­–
decision_data = {
    "content": "é€‰æ‹©Reactè€Œä¸æ˜¯Vueä½œä¸ºå‰ç«¯æ¡†æ¶",
    "related": ["æŠ€æœ¯é€‰æ‹©", "å‰ç«¯", "React"],
    "emotion": "ä¸­æ€§",
    "context": "æ–°é¡¹ç›®æŠ€æœ¯æ ˆé€‰æ‹©",
    "outcome": "å›¢é˜Ÿæ›´ç†Ÿæ‚‰Reactï¼Œå¼€å‘æ•ˆç‡æ›´é«˜"
}
db.insert_record("decisions", decision_data)
```

### ç¤ºä¾‹4: æ•°æ®åˆ†æ
```python
# è·å–ç»Ÿè®¡ä¿¡æ¯
stats = db.get_statistics()
print(f"æ€»è®°å½•æ•°: {sum(stats.values())}")

# æœç´¢ç‰¹å®šä¸»é¢˜
learning_records = db.search_records("all", "å­¦ä¹ ")
print(f"æ‰¾åˆ° {len(learning_records)} æ¡å…³äºå­¦ä¹ çš„è®°å½•")

# è·å–æœ€è¿‘çš„è®°å½•
recent = db.get_records("beliefs", limit=5, order_by="create_time DESC")
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æ•°æ®åº“æ–‡ä»¶æƒé™é—®é¢˜
```bash
# ç¡®ä¿æ•°æ®åº“æ–‡ä»¶æœ‰è¯»å†™æƒé™
chmod 644 personal_profile.db
```

#### 2. ä¾èµ–åŒ…å®‰è£…é—®é¢˜
```bash
# å‡çº§pip
pip install --upgrade pip

# é‡æ–°å®‰è£…ä¾èµ–
pip install -r requirements.txt --force-reinstall
```

#### 3. MCPæœåŠ¡å™¨å¯åŠ¨å¤±è´¥
```bash
# æ£€æŸ¥Pythonè·¯å¾„
python --version

# æ£€æŸ¥æ¨¡å—å¯¼å…¥
python -c "from src.database import PersonalProfileDatabase; print('å¯¼å…¥æˆåŠŸ')"
```

#### 4. æ•°æ®åº“è¿æ¥é—®é¢˜
- æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
- ç¡®ä¿æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´
- æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿæƒé™

### æ—¥å¿—è°ƒè¯•

å¯ç”¨è¯¦ç»†æ—¥å¿—ï¼š
```bash
export LOG_LEVEL=DEBUG
python run_server.py
```

### æ€§èƒ½ä¼˜åŒ–

1. **å®šæœŸæ¸…ç†**: åˆ é™¤ä¸éœ€è¦çš„æ—§è®°å½•
2. **ç´¢å¼•ä¼˜åŒ–**: ç³»ç»Ÿå·²è‡ªåŠ¨åˆ›å»ºæ—¶é—´ç´¢å¼•
3. **æ‰¹é‡æ“ä½œ**: ä½¿ç”¨äº‹åŠ¡è¿›è¡Œæ‰¹é‡æ’å…¥

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ã€‚è¯¦è§LICENSEæ–‡ä»¶ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ï¼

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- æäº¤GitHub Issue
- æŸ¥çœ‹æ–‡æ¡£å’Œç¤ºä¾‹ä»£ç 
- è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯ç¯å¢ƒ 